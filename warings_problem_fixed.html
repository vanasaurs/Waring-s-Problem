<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Waring's Problem</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Waring's Problem</h1>
</header>
<p>The Waring’s Problem asks about the estimation of <span
class="math display">\[r_{k,s}(N)\;:=\;
\bigl|\{(x_1,\dots,x_s)\in\mathbb{N}^s:\;
x_1^k+\cdots+x_s^k=N\}\bigr|.\]</span></p>
<p><strong>Theorem (Hardy and Littlewood).</strong> <em>For <span
class="math inline">\(s\ge s_0(k)\)</span>, there exists <span
class="math inline">\(\delta=\delta(s,k)&gt;0\)</span> such that</em>
<span class="math display">\[r_{k,s}(N)
  = \mathfrak{S}(N)\,
    \Gamma\!\Bigl(1+\frac1k\Bigr)^s
    \Gamma\!\Bigl(\frac{s}{k}\Bigr)^{-1}
    N^{\frac{s}{k}-1}
    + O\!\Bigl(N^{\frac{s}{k}-1-\delta}\Bigr),\]</span> <em>where <span
class="math inline">\(\Gamma(x)\)</span> is the gamma function, <span
class="math inline">\(\mathfrak{S}(N)\)</span> is the “singular series”,
and we prove this for <span
class="math inline">\(s_0=2^k+1\)</span>.</em></p>
<p>By orthogonality, it can be written as <span
class="math display">\[r_{k,s}(N)
  = \int_0^1 \!\!\Bigl(\sum_{n=1}^{P} \mathrm{e(n^k\alpha)}\Bigr)^{\!s}
     \mathrm{e(-N\alpha)}\, \mathrm{d}\alpha
  = \int_0^1 \! F(\alpha)^s \, \mathrm{e(-N\alpha)}\,
\mathrm{d}\alpha,\]</span> where <span
class="math display">\[P=\bigl\lfloor N^{1/k}\bigr\rfloor
  \qquad\text{and}\qquad
  F(\alpha)=\sum_{n=1}^{P} \mathrm{e(n^k\alpha)}.\]</span></p>
<p>Let <span class="math inline">\(N\ge 2^k\)</span>, choose <span
class="math inline">\(0&lt;\nu&lt;\tfrac15\)</span>. Then we construct
the major arcs <span class="math inline">\(\mathfrak{M}\)</span> and
minor arcs <span class="math inline">\(\mathfrak{m}\)</span> as follows:
<span class="math display">\[\mathfrak{M}
  = \bigcup_{q\le P^{\nu}}
      \ \bigcup_{\substack{0\le a&lt;q\\(a,q)=1}}
      \Bigl\{\alpha\in[0,1]:\,
        \bigl|\alpha-\tfrac{a}{q}\bigr|
        \le \frac{1}{q\,P^{k\nu}}
      \Bigr\},
  \qquad
  \mathfrak{m}=[0,1]\setminus\mathfrak{M}.\]</span></p>
<p>And it is not difficult to verify that each interval in <span
class="math inline">\(\mathfrak{M}\)</span> does not overlap. Then, we
can calculate <span class="math inline">\(r_{k,s}(N)\)</span> by
evaluating the integral over the major arcs <span
class="math inline">\(\mathfrak{M}\)</span> and the minor arcs <span
class="math inline">\(\mathfrak{m}\)</span>.</p>
<p>Now, we first estimate the integral over the minor arcs.<br />
<strong>Theorem.</strong> <em>Let <span class="math inline">\(k\ge
2\)</span> and <span class="math inline">\(s\ge 2^k+1\)</span>. There
exists <span class="math inline">\(\delta&gt;0\)</span> such that</em>
<span class="math display">\[\int_{\mathfrak{m}} \! |F(\alpha)|^s\,
\mathrm{e(-N\alpha)} \, \mathrm{d}\alpha
  \; \ll \; P^{\,s-k-\delta},\]</span> <em>where the constant depends
only on <span class="math inline">\(k\)</span> and <span
class="math inline">\(s\)</span>.</em></p>
<p><strong>Proof.</strong> By Dirichlet’s approximation, if <span
class="math inline">\(\alpha\in\mathfrak{m}\)</span> with <span
class="math inline">\(Q=P^{k-\nu}\)</span>, then there exist <span
class="math inline">\((a,q)\)</span> such that <span
class="math inline">\((a,q)=1\)</span>, <span
class="math inline">\(P^\nu&lt;q\le Q\)</span>, and <span
class="math display">\[\left| \alpha - \frac{a}{q} \right|
  \le \frac{1}{qQ}
  \le \frac{1}{q P^{k-\nu}}.\]</span> By Weyl’s inequality, with <span
class="math inline">\(K=2^{\,k-1}\)</span>, it yields that <span
class="math display">\[F(\alpha) \ \ll\
  P^{\,1+\varepsilon} \left( \frac{1}{P} + \frac{1}{q} + \frac{q}{P^k}
\right)^{1/K}
  \ \ll\ P^{\,1+\varepsilon - \nu/k}.\]</span></p>
<p><strong>Lemma (Hua).</strong> For <span class="math inline">\(k\ge
2\)</span>, let <span class="math display">\[T(\alpha) \;=\;
\sum_{n=1}^N \mathrm{e(\alpha n^k)}.\]</span> Then <span
class="math display">\[\int_0^1 |T(\alpha)|^{2^k} \, \mathrm{d}\alpha
  \ \ll\ N^{2^k - k + \varepsilon}.\]</span></p>
<p>Hence, by applying Hua’s lemma, we obtain <span
class="math display">\[\int_{\mathfrak{m}} |F(\alpha)|^s\,
\mathrm{e(-N\alpha)} \, \mathrm{d}\alpha
  \ \ll\
  \max_{\alpha\in\mathfrak{m}} |F(\alpha)|^{\,s-2^k}
  \ \int_0^1 |F(\alpha)|^{\,2^k} \, \mathrm{d}\alpha\]</span> <span
class="math display">\[\ll\ P^{\,s - k - \delta_1},\]</span> where <span
class="math display">\[\delta_1
  = \frac{\nu(2^{\,k} - k)}{k}
    - \bigl(s - 2^k + 1\bigr) \varepsilon
  &gt; 0.\]</span> Then, we are done.<br />
<br />
As for the major arcs part, we introduce the following functions <span
class="math display">\[v(\beta) = \sum_{m=1}^{N} \frac{1}{k} m^{\frac1k
- 1} \, \mathrm{e(\beta m)}
  \quad\text{and}\quad
  S(q,a) = \sum_{r=1}^{q} \mathrm{e(a r^k / q)}.\]</span></p>
<p>Let <span class="math inline">\(\beta = \alpha -
\frac{a}{q}\)</span>, then for <span class="math inline">\(\alpha \in
\mathfrak{M}\)</span>, we have <span class="math inline">\(|\beta| \le
P^{\nu-k}\)</span> and <span class="math display">\[\begin{aligned}
  F(\alpha) - \frac{S(q,a)}{q} v(\beta)
  &amp;= \sum_{m=1}^{P} \mathrm{e(\frac{a m^k}{q})} \, \mathrm{e(\beta
m^k)}
    - \frac{S(q,a)}{q} \sum_{m=1}^{N} \frac{1}{k} m^{\frac1k - 1}
\mathrm{e(\beta m)}\\
  &amp;= \sum_{m=1}^{N} u(m) \, \mathrm{e(\beta
m)},\end{aligned}\]</span> where <span class="math display">\[u(m) =
  \begin{cases}
    \mathrm{e(\frac{a m^k}{q})} - \frac{S(q,a)}{q} \frac{1}{k}
m^{\frac1k - 1},
      &amp;\text{if $m$ is a $k$-th power},\\[4pt]
    - \frac{S(q,a)}{q} \frac{1}{k} m^{\frac1k - 1},
      &amp;\text{otherwise}.
  \end{cases}\]</span> Since <span class="math inline">\(|S(q,a)| \le
q\)</span> and <span class="math inline">\(\sum_{m\le t} \frac{1}{k}
m^{\frac1k - 1} = t^{1/k} + O(1)\)</span>, we obtain <span
class="math display">\[\begin{aligned}
  U(t) &amp;= \sum_{m \le t}u(m)\\
  &amp;=\sum_{m \le t^{1/k}} \mathrm{e(\frac{a m^k}{q})}
    - \frac{S(q,a)}{q} \sum_{m \le t} \frac{1}{k} m^{\frac1k - 1}\\
  &amp;= O(q).\end{aligned}\]</span></p>
<p>By Abel’s summation, it yields that <span
class="math display">\[\sum_{m=1}^{N} u(m) \mathrm{e(\beta m)}
  = \mathrm{e(\beta N)} U(N)
    - 2\pi i \beta \int_1^{N} \mathrm{e(\beta t)} U(t) \, \mathrm{d}t
  \ \ll\ (1 + |\beta| N) q
  \ \ll\ P^{\nu}.\]</span></p>
<p><strong>Theorem.</strong> Let <span
class="math display">\[\mathfrak{S}(N,Q) =
  \sum_{q \le Q}
    \sum_{\substack{a=1 \\ (a,q)=1}}^{q}
      \left( \frac{S(q,a)}{q} \right)^{\!s}
      \mathrm{e(-Na/q)},\]</span> and <span
class="math display">\[J^*(N) = \int_{-P^{\nu-k}}^{P^{\nu-k}}
    v(\beta)^s \, \mathrm{e(-N\beta)} \, \mathrm{d}\beta.\]</span></p>
<p><span class="math display">\[\int_{\mathfrak{M}} F(\alpha)^s \,
\mathrm{e(-N\alpha)} \, \mathrm{d}\alpha
  = \mathfrak{S}(N, P^{\nu}) \, J^*(N)
    + O\!\bigl( P^{\,s-k-\delta_2} \bigr)\]</span> where <span
class="math display">\[\delta_2 = \frac{1 - 5\nu}{k} &gt;
0.\]</span></p>
<p><strong>Proof.</strong> Let <span class="math inline">\(\beta =
\alpha - \frac{a}{q}\)</span>, <span class="math inline">\(V =
\frac{S(q,a)}{q} v(\beta)\)</span>, and <span class="math inline">\(F =
F(\alpha)\)</span>, then <span
class="math display">\[\int_{\mathfrak{M}} |F^s - V^s| \,
\mathrm{d}\alpha
  \ \ll\ \mu(m)\, (F - V)\,
      \bigl(F^{s-1} + F^{s-2}V + \cdots + V^{s-1}\bigr)\]</span> <span
class="math display">\[\ll\ P^{3\nu - k} \, P^{\,s-1+\nu}
  \ \ll\ P^{\,s-k-\delta_2}\]</span> where <span
class="math inline">\(\delta_2 = 1 - 5\nu &gt; 0\)</span>.</p>
<p>Therefore, <span class="math display">\[\begin{aligned}
  \int_{\mathfrak{M}} F(\alpha)^s \, \mathrm{e(-N\alpha)} \,
\mathrm{d}\alpha
  &amp;= \sum_{q\le P^\nu}
      \sum_{\substack{a=1 \\ (a,q)=1}}^{q}
        \int_{\mathfrak{M}(q,a)}
          V^s \, \mathrm{e(-N\alpha)} \, \mathrm{d}\alpha
      + O\!\bigl(P^{\,s-k-\delta_2}\bigr)\\
  &amp;= \mathfrak{S}(N,P^\nu) \, J^*(N)
      + O\!\bigl(P^{\,s-k-\delta_2}\bigr).\end{aligned}\]</span> This
completes the proof.</p>
<p>Then we estimate the singular series <span
class="math inline">\(\mathfrak{S}(N,P^\nu)\)</span> and the singular
integral <span class="math inline">\(J^*(N)\)</span>, respectively.</p>
<p>Let <span class="math display">\[J(N) = \int_{-\infty}^{\infty}
v(\beta)^s \, \mathrm{e(-N\beta)} \, \mathrm{d}\beta,\]</span> it
follows that <span class="math display">\[J(N) = J^*(N) +
O\!\bigl(P^{\,s-k-\delta_3}\bigr)\]</span> where <span
class="math display">\[\delta_3 = \nu \bigl( \tfrac{s}{k} - 1 \bigr)
&gt; 0.\]</span></p>
<p><strong>Lemma.</strong> Let <span class="math inline">\(\alpha, \beta
\in \mathbb{R}\)</span> such that <span class="math inline">\(0 &lt;
\beta &lt; 1\)</span> and <span class="math inline">\(\alpha \ge
\beta\)</span>. Then <span class="math display">\[\sum_{m=1}^{N}
m^{\beta - 1} (N-m)^{\alpha - 1}
  = N^{\alpha + \beta - 1}
\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}
    + O\!\bigl(N^{\alpha - 1}\bigr),\]</span> where the implied constant
depends only on <span class="math inline">\(\beta\)</span>.</p>
<p><strong>Theorem.</strong> If <span class="math inline">\(s \ge
2\)</span>, then <span class="math display">\[J(N) = \Gamma\!\Bigl(1 +
\tfrac{1}{k}\Bigr)^{\!s}
          \, \Gamma\!\Bigl(\tfrac{s}{k}\Bigr)^{-1}
          \, N^{\,\frac{s}{k} - 1}
          + O\!\bigl( N^{\frac{s-1}{k} - 1} \bigr).\]</span></p>
<p><strong>Proof.</strong> Let <span class="math display">\[J_s(N) =
\int_{-\infty}^{\infty} v(\beta)^s \, \mathrm{e(-N\beta)} \,
\mathrm{d}\beta\]</span> for <span class="math inline">\(s \ge
1\)</span>. We shall prove the theorem by induction on <span
class="math inline">\(s\)</span>. For <span class="math inline">\(s =
2\)</span>, we obtain <span class="math display">\[J_2(N)
  = k^{-2} \sum_{m=1}^{N} m^{\frac1k - 1} (N-m)^{\frac1k - 1}
  = \frac{\Gamma(1+\frac1k)^2}{\Gamma(\frac{2}{k})}
    \, N^{\frac{2}{k} - 1}
    + O\!\bigl( N^{\frac1k - 1} \bigr).\]</span> By induction, for <span
class="math inline">\(s \to s+1\)</span>, we have <span
class="math display">\[\begin{aligned}
  J_{s+1}(N)
&amp;= \frac1k \sum_{m=1}^{N} m^{\frac1k - 1} \, J_s(N-m)\\
  &amp;= \frac{\Gamma(1+\frac1k)^{s+1}}{\Gamma\bigl( \frac{s+1}{k}
\bigr)}
    \, N^{\frac{s+1}{k} - 1}
    + O\!\bigl( N^{\frac{s}{k} - 1} \bigr).\end{aligned}\]</span> This
completes the induction.<br />
</p>
<p><span class="math inline">\(\mathfrak{S}(N,q)\)</span> is not exactly
the singular series that we are going to estimate; instead, we work on
<span class="math display">\[\mathfrak{S}(N) = \sum_{q=1}^{\infty}
A_N(q)\]</span> where <span class="math display">\[A_N(q) =
\sum_{\substack{a=1 \\ (a,q)=1}}^{q}
             \left( \frac{S(q,a)}{q} \right)^{\!s}
\mathrm{e(-Na/q)}.\]</span> By Weyl’s inequality, <span
class="math display">\[\frac{S(q,a)}{q} \ \ll\ q^{-1/k +
\varepsilon}\]</span> with <span class="math inline">\(K =
2^{k-1}\)</span>, for sufficiently small <span
class="math inline">\(\varepsilon\)</span>, so that <span
class="math display">\[\delta_4 = \frac1k - s\varepsilon &gt;
0,\]</span> it follows that <span class="math display">\[A_N(q) \ \ll\
\frac{q}{q^{s/k - s\varepsilon}}
   \ \le\ \frac{1}{q^{1+\delta_4}}.\]</span> Hence, <span
class="math inline">\(\mathfrak{S}(N)\)</span> converges absolutely, and
<span class="math display">\[\mathfrak{S}(N) - \mathfrak{S}(N, P^\nu) \
\ll\ P^{-\nu \delta_4}.\]</span> By the property that <span
class="math inline">\(S(qr, ar + bq) = S(a,q) S(r,b)\)</span> for <span
class="math inline">\((a,r)=1\)</span>, then for <span
class="math inline">\((q,r)=1\)</span>, we have <span
class="math display">\[A_N(qr) = A_N(q) \, A_N(r).\]</span> Let <span
class="math inline">\(M_N(q)\)</span> denote the number of solutions of
the congruence <span class="math display">\[x_1^k + x_2^k + \cdots +
x_s^k \equiv N \pmod{q}\]</span> in integers <span
class="math inline">\(x_i\)</span> such that <span
class="math inline">\(1 \le x_i \le q\)</span> for <span
class="math inline">\(i=1,\dots,s\)</span>. Let <span
class="math inline">\(s \ge 2^k + 1\)</span>. For every prime <span
class="math inline">\(p\)</span>, the series <span
class="math display">\[\chi_N(p) = 1 + \sum_{h=1}^{\infty}
A_N(p^h)\]</span> converges; then <span
class="math display">\[\mathfrak{S}(N) = \prod_{p}
\chi_N(p).\]</span></p>
<p><strong>Note.</strong></p>
<p><span class="math display">\[\begin{aligned}
  M_N(q)
  &amp;= \sum_{x_1=1}^{q} \cdots \sum_{x_s=1}^{q} \frac{1}{q}
    \sum_{a=1}^{q} \mathrm{e(\frac{a(x_1^k + \cdots + x_s^k - N)}{q})}\\
  &amp;= \frac1q \sum_{a=1}^q S(q,a)^s \, \mathrm{e(-aN/q)}
  = \frac1q \sum_{d \mid q} \sum_{\substack{a=1 \\ (a,q)=d}}^{q}
      S(q,a)^s \, \mathrm{e(-aN/q)}\\
  &amp;= \frac1q \sum_{d \mid q} \sum_{\substack{a_1=1 \\ (a_1,
q/d)=1}}^{q/d}
      d^s S(q/d, a_1)^s \, \mathrm{e(- (a_1 N) / (q/d))}\\
  &amp;= q^{s-1} \sum_{d \mid q} A_N\!\left( \frac{q}{d}
\right).\end{aligned}\]</span></p>
<p>Therefore, <span class="math display">\[\begin{aligned}
  \chi_N(p)
  &amp;= \lim_{h \to \infty} \left( 1 + \sum_{j=1}^h A_N(p^j) \right)\\
  &amp;= \lim_{h \to \infty} \sum_{d \mid p^h} A_N\!\left( \frac{p^h}{d}
\right)\\
  &amp;= \lim_{h \to \infty} p^{h(1-s)} \,
M_N(p^h).\end{aligned}\]</span> By considering <span
class="math inline">\(M_N(p^r)\)</span> where <span
class="math inline">\(r\)</span> is a certain positive number depending
only on <span class="math inline">\(k\)</span> and smaller than <span
class="math inline">\(h\)</span>, it suffices to deduce that <span
class="math display">\[\chi_N(p) &gt; 0,
  \quad \text{and} \quad
  c_1 &lt; \mathfrak{S}(N) &lt; c_2,\]</span> where <span
class="math inline">\(c_1, c_2\)</span> depends on <span
class="math inline">\(k\)</span> and <span
class="math inline">\(s\)</span>. Hence, we complete the proof of the
theorem.</p>
</body>
</html>
